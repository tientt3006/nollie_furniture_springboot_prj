<!DOCTYPE html>
<html lang="vi">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Orders</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="stylesheet" href="admin.css">
    <style>
        /* Custom button styles */
        .btn-custom {
            color: white;
            background-color: black;
            border: none;
        }

        .btn-custom:hover {
            background-color: #333;
        }

        .filter-bar .form-control,
        .filter-bar .form-select {
            margin-right: 10px;
        }
    </style>
</head>

<body>

    <div class="wrapper">



        <header class="header">
            
                <div class="logo">
                    <a href="../home/home.html" class="logo-link" style="display: flex; text-decoration: none;">
                    <img src="../../images/logoonly.png" alt="Logo">
                    <p class="logo-name">NollieConcept</p>
                    </a>
                </div>
                <div class="nav-right nav-icons">
                    <div class="user-dropdown">
                        <img src="../../images/user.png" alt="User" class="icon user-icon">
                        <div class="dropdown-menu">
                            <!-- Default options for logged-out users -->
                            <a href="../io/signin.html" class="dropdown-item" id="signin">Sign In</a>
                            <a href="../io/signup.html" class="dropdown-item" id="signup">Sign Up</a>
                            <!-- Options for logged-in users (hidden by default) -->
                            <a href="../io/userinfo.html" class="dropdown-item" id="info" style="display: none;">Info</a>
                            <a href="../home/home.html" class="dropdown-item" id="logout" style="display: none;">Logout</a>
                        </div>
                    </div>
                </div>
        </header>



        <div class="main-container">



            <div class="second-main-container">
                <div class="sidebar">
                    <h3>Admin</h3>
                    <a href="./product_management.html">Products</a>
                    <a href="./option_management.html">Options</a>
                    <a href="./user_management.html">Users</a>
                    <a href="./order_list.html">Orders</a>
                    
                </div>


                
                <section class="order-list-section container mt-4">
                    <h2>Order Lists</h2>
                    <div class="filter-bar d-flex justify-content-between align-items-center p-3 bg-light rounded">
                        <div class="filter-options d-flex">
                            <label for="filter-start-date" class="me-2">Start Date:</label>
                            <input type="date" id="filter-start-date" class="form-control me-2">

                            <label for="filter-end-date" class="me-2">End Date:</label>
                            <input type="date" id="filter-end-date" class="form-control me-2">

                            <label for="filter-status" class="me-2">Order Status:</label>
                            <select id="filter-status" class="form-select me-2">
                                <option value="all" selected>All</option>
                                <option value="completed">Completed</option>
                                <option value="shipping">Shipping</option>
                                <option value="received">Received</option>
                                <option value="canceled">Canceled</option>
                            </select>

                            <!-- <label for="filter-payment-method" class="me-2">Payment Method:</label>
                            <select id="filter-payment-method" class="form-select me-2">
                                <option value="all" selected>All</option>
                                <option value="credit-card">Credit Card</option>
                                <option value="paypal">PayPal</option>
                                <option value="cash">Cash</option>
                            </select> -->

                            <!-- <label for="filter-category" class="me-2">Category:</label>
                            <select id="filter-category" class="form-select me-2">
                                <option value="all" selected>All</option>
                                <option value="furniture">Furniture</option>
                                <option value="decor">Decor</option>
                                <option value="lighting">Lighting</option>
                            </select> -->

                            <label for="search-name" class="me-2">Search Name:</label>
                            <input type="text" id="search-name" class="form-control me-2" placeholder="Search by Name">

                            <button class="btn btn-custom" id="search-button">Search</button>
                        </div>
                        <div class="d-flex">
                            <label for="page-size" class="me-2">Page Size:</label>
                            <select id="page-size" class="form-select me-2">
                                <option value="10" selected>10</option>
                                <option value="20">20</option>
                                <option value="50">50</option>
                            </select>
                            <button class="btn btn-custom" id="reset-filter">Reset Filter</button>
                        </div>
                    </div>
                    <table class="table mt-3">
                        <thead>
                            <tr>
                                <th>ID</th>
                                <th>Name</th>
                                <th>Address</th>
                                <th>Date</th>
                                <th>Total</th>
                                <th>Status</th>
                                <th>Action</th> <!-- Added Action column -->
                            </tr>
                        </thead>
                        <tbody id="order-table-body">
                            <!-- Sample orders will be dynamically generated -->
                            <tr>
                                <td>00001</td>
                                <td>Customer 1</td>
                                <td>Address 1</td>
                                <td>2023-10-01</td>
                                <td>100000</td>
                                <td>Completed</td>
                                <td>
                                    <button class="btn btn-custom btn-update-status">Update Status</button>
                                    <button class="btn btn-custom btn-cancel-order">Cancel Order</button>
                                    <a href="../io/order_detail.html"><button class="btn btn-custom btn-cancel-order">Detail</button></a>
                                </td>
                            </tr>
                            <!-- Add more sample rows -->
                            <tr>
                                <td>00002</td>
                                <td>Customer 2</td>
                                <td>Address 2</td>
                                <td>2023-10-02</td>
                                <td>200000</td>
                                <td>Shipping</td>
                                <td>
                                    <button class="btn btn-custom btn-update-status">Update Status</button>
                                    <button class="btn btn-custom btn-cancel-order">Cancel Order</button>
                                    <a href="../io/order_detail.html"><button class="btn btn-custom btn-cancel-order">Detail</button></a>
                                </td>
                            </tr>
                            <tr>
                                <td>00003</td>
                                <td>Customer 3</td>
                                <td>Address 3</td>
                                <td>2023-10-03</td>
                                <td>300000</td>
                                <td>Received</td>
                                <td>
                                    <button class="btn btn-custom btn-update-status">Update Status</button>
                                    <button class="btn btn-custom btn-cancel-order">Cancel Order</button>
                                    <a href="../io/order_detail.html"><button class="btn btn-custom btn-cancel-order">Detail</button></a>
                                </td>
                                        
                            </tr>
                            <!-- Add more rows as needed -->
                        </tbody>
                    </table>
                    <div class="pagination d-flex justify-content-between align-items-center">
                        <span id="pagination-info">Showing 1-9 of 78</span>
                        <div class="d-flex align-items-center">
                            <button class="btn btn-custom me-2" id="prev-page">&lt;</button>
                            <input type="number" id="page-input" class="form-control me-2" style="width: 60px;" min="1" placeholder="Page">
                            <button class="btn btn-custom" id="next-page">&gt;</button>
                        </div>
                    </div>
                </section>

            </div>
        </div>


    </div>
    <script src="admin.js"></script>
    <script>
        
// Handle order status changes
document.querySelectorAll(".order-status").forEach((select) => {
    select.addEventListener("change", (event) => {
        const orderId = event.target.dataset.orderId;
        const newStatus = event.target.value;

        // Simulate saving the new status (replace with actual API call)
        console.log(`Order ID: ${orderId}, New Status: ${newStatus}`);

        // Optionally, show a success message or update the UI
        alert(`Order ${orderId} status updated to ${newStatus}`);
    });
});

// Sample orders data
const orders = Array.from({ length: 78 }, (_, i) => ({
    id: String(i + 1).padStart(5, "0"),
    name: `Customer ${i + 1}`,
    address: `Address ${i + 1}`,
    date: `2023-10-${String((i % 30) + 1).padStart(2, "0")}`,
    total: `${(Math.random() * 1000000).toFixed(0)}`,
    status: ["completed", "shipping", "received", "canceled"][i % 4],
}));

// Pagination variables
let currentPage = 1;
const rowsPerPage = 9;

// Render orders for the current page
function renderOrders() {
    const tableBody = document.getElementById("order-table-body");
    tableBody.innerHTML = "";

    const start = (currentPage - 1) * rowsPerPage;
    const end = start + rowsPerPage;
    const paginatedOrders = orders.slice(start, end);

    paginatedOrders.forEach((order) => {
        const row = document.createElement("tr");
        row.innerHTML = `
            <td>${order.id}</td>
            <td>${order.name}</td>
            <td>${order.address}</td>
            <td>${order.date}</td>
            <td>${order.total}</td>
            <td>
                <select class="form-select order-status" data-order-id="${order.id}">
                    <option value="completed" ${order.status === "completed" ? "selected" : ""}>Completed</option>
                    <option value="shipping" ${order.status === "shipping" ? "selected" : ""}>Shipping</option>
                    <option value="received" ${order.status === "received" ? "selected" : ""}>Received</option>
                    <option value="canceled" ${order.status === "canceled" ? "selected" : ""}>Canceled</option>
                </select>
            </td>
            <td>
                <button class="btn btn-primary btn-detail" data-order-id="${order.id}">Detail</button>
            </td>
        `;
        tableBody.appendChild(row);
    });

    document.getElementById("pagination-info").textContent = `Showing ${start + 1}-${Math.min(end, orders.length)} of ${orders.length}`;
}

// Filter variables
const filterDate = document.getElementById("filter-date");
const filterRange = document.getElementById("filter-range");
const filterStatus = document.getElementById("filter-status");
const resetFilter = document.getElementById("reset-filter");
const searchInput = document.getElementById("search-input");

// Filter orders based on selected criteria
function filterOrders() {
    const selectedDate = filterDate.value;
    const selectedRange = filterRange.value;
    const selectedStatus = filterStatus.value;

    let filteredOrders = [...orders];

    // Filter by date
    if (selectedDate) {
        filteredOrders = filteredOrders.filter(order => order.date === selectedDate);
    }

    // Filter by range
    if (selectedRange === "last7days") {
        const last7Days = new Date();
        last7Days.setDate(last7Days.getDate() - 7);
        filteredOrders = filteredOrders.filter(order => new Date(order.date) >= last7Days);
    } else if (selectedRange === "last30days") {
        const last30Days = new Date();
        last30Days.setDate(last30Days.getDate() - 30);
        filteredOrders = filteredOrders.filter(order => new Date(order.date) >= last30Days);
    }

    // Filter by status
    if (selectedStatus !== "all") {
        filteredOrders = filteredOrders.filter(order => order.status === selectedStatus);
    }

    return filteredOrders;
}

// Search orders based on search input
function searchOrders() {
    const searchValue = searchInput.value.toLowerCase();
    return orders.filter(order => 
        order.id.toLowerCase().includes(searchValue) || 
        order.name.toLowerCase().includes(searchValue)
    );
}

// Render filtered orders
function renderFilteredOrders() {
    const filteredOrders = filterOrders().filter(order => 
        searchOrders().includes(order)
    );
    const start = (currentPage - 1) * rowsPerPage;
    const end = start + rowsPerPage;
    const paginatedOrders = filteredOrders.slice(start, end);

    const tableBody = document.getElementById("order-table-body");
    tableBody.innerHTML = "";

    paginatedOrders.forEach(order => {
        const row = document.createElement("tr");
        row.innerHTML = `
            <td>${order.id}</td>
            <td>${order.name}</td>
            <td>${order.address}</td>
            <td>${order.date}</td>
            <td>${order.total}</td>
            <td>
                <select class="form-select order-status" data-order-id="${order.id}">
                    <option value="completed" ${order.status === "completed" ? "selected" : ""}>Completed</option>
                    <option value="shipping" ${order.status === "shipping" ? "selected" : ""}>Shipping</option>
                    <option value="received" ${order.status === "received" ? "selected" : ""}>Received</option>
                    <option value="canceled" ${order.status === "canceled" ? "selected" : ""}>Canceled</option>
                </select>
            </td>
            <td>
                <button class="btn btn-primary btn-detail" data-order-id="${order.id}">Detail</button>
            </td>
        `;
        tableBody.appendChild(row);
    });

    document.getElementById("pagination-info").textContent = `Showing ${start + 1}-${Math.min(end, filteredOrders.length)} of ${filteredOrders.length}`;
}

// Reset filters
resetFilter.addEventListener("click", () => {
    filterDate.value = "";
    filterRange.value = "all";
    filterStatus.value = "all";
    searchInput.value = "";
    currentPage = 1;
    renderFilteredOrders();
});

// Update orders on filter change
[filterDate, filterRange, filterStatus].forEach(filter => {
    filter.addEventListener("change", () => {
        currentPage = 1;
        renderFilteredOrders();
    });
});

// Update orders on search input change
searchInput.addEventListener("input", () => {
    currentPage = 1;
    renderFilteredOrders();
});

// Add event listener for search button
document.getElementById("search-button").addEventListener("click", () => {
    currentPage = 1;
    renderFilteredOrders();
});

// Update pagination buttons to work with filters
document.getElementById("prev-page").addEventListener("click", () => {
    if (currentPage > 1) {
        currentPage--;
        renderFilteredOrders();
    }
});

document.getElementById("next-page").addEventListener("click", () => {
    const filteredOrders = filterOrders();
    if (currentPage * rowsPerPage < filteredOrders.length) {
        currentPage++;
        renderFilteredOrders();
    }
});

// Add event listener for custom page input
document.getElementById("page-input").addEventListener("change", (event) => {
    const page = parseInt(event.target.value, 10);
    if (page >= 1 && page <= Math.ceil(orders.length / rowsPerPage)) {
        currentPage = page;
        renderFilteredOrders();
    } else {
        alert("Invalid page number");
    }
});

// Initial render with filters
renderFilteredOrders();

// Handle "Detail" button clicks
document.addEventListener("click", (event) => {
    if (event.target.classList.contains("btn-detail")) {
        const orderId = event.target.dataset.orderId;
        window.location.href = `../io/order_detail.html?orderId=${orderId}`; // Redirect to order_detail.html with orderId
    }
});
    </script>
    <script src="admin.js"></script>
</body>

</html>